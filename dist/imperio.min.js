/*! Copyright Imperiojs */
!function(e){function o(i){if(n[i])return n[i].exports;var t=n[i]={exports:{},id:i,loaded:!1};return e[i].call(t.exports,t,t.exports,o),t.loaded=!0,t.exports}var n={};return o.m=e,o.c=n,o.p="",o(0)}([function(e,o,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var t=n(28),r=i(t),c={};c.socket=io(),c.room=(0,r["default"])("roomId"),c.nonce=(0,r["default"])("nonce"),c.webRTCSupport=n(4),c.webRTCConfiguration={iceServers:[{url:"stun:stun.l.google.com:19302"}]},c.connectionType=null,c.webRTCConnect=n(31),c.dataChannel=null,c.peerConnection=null,c.callbacks={},c.mobileTapShare=n(24),c.mobileAccelShare=n(19),c.mobileGeoLocationShare=n(20),c.mobileGyroShare=n(21),c.mobileRoomSetup=n(22),c.mobileRoomUpdate=n(23),c.requestNonceTimeout=n(25),c.desktopTapHandler=n(10),c.desktopGeoLocationHandler=n(6),c.desktopAccelHandler=n(5),c.desktopGyroHandler=n(7),c.desktopRoomSetup=n(8),c.curse=n(12);var a=["pan","pinch","press","pressUp","rotate","swipe"];a.forEach(function(e){var o="desktop"+(e[0].toUpperCase()+e.substring(1))+"Handler";c[o]=function(o){c.callbacks[e]=o,c.socket.on(e,function(e){o&&o(e)})}}),c.desktopRoomUpdate=n(9),c.nonceTimeoutUpdate=n(11),window.imperio=c},function(e,o){"use strict";e.exports=function(e){return console.log(e.toString(),e)}},function(e,o,n){"use strict";var i=n(3),t=n(1),r=function(e){imperio.peerConnection.setLocalDescription(e,function(){i(imperio.peerConnection.localDescription)},t)};e.exports=r},function(e,o){"use strict";var n=function(e){console.log("Client sending message: "+e),imperio.socket.emit("message",e,imperio.room)};e.exports=n},function(e,o){"use strict";var n=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,i=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;e.exports=!!n&&!!i},function(e,o){"use strict";var n=function(e){imperio.callbacks.acceleration=e,imperio.socket.on("acceleration",function(o){e&&e(o)})};e.exports=n},function(e,o){"use strict";var n=function(e){imperio.callbacks.geoLocation=e,imperio.socket.on("geoLocation",function(o){e&&e(o)})};e.exports=n},function(e,o){"use strict";var n=function(e){imperio.callbacks.gyroscope=e,imperio.socket.on("gyroscope",function(o){e&&e(o)})};e.exports=n},function(e,o){"use strict";var n=function(e){imperio.socket.on("connect",function(){if(imperio.connectionType="sockets",imperio.room){var o={room:imperio.room,id:imperio.socket.id,role:"receiver"};imperio.socket.emit("createRoom",o)}e&&e()})};e.exports=n},function(e,o){"use strict";var n=function(e){imperio.socket.on("updateRoomData",function(o){e&&e(o)})};e.exports=n},function(e,o){"use strict";var n=function(e){imperio.callbacks.tap=e,imperio.socket.on("tap",function(o){e&&e(o)})};e.exports=n},function(e,o){"use strict";var n=function(e){imperio.socket.on("updateNonceTimeouts",function(o){e&&e(o)})};e.exports=n},function(e,o,n){"use strict";function i(e,o,n){new Hammer(o);"pan"===e&&t(o,n),"pinch"===e&&r(o,n),"press"===e&&c(o,n),"pressUp"===e&&a(o,n),"rotate"===e&&p(o,n),"swipe"===e&&s(o,n)}var t=n(13),r=n(14),c=n(15),a=n(16),p=n(17),s=n(18);e.exports=i},function(e,o){"use strict";var n=function(e,o){var n=new Hammer(e);n.on("pan",function(e){e.start=!1,e.end=!1,e.type="pan","webRTC"===imperio.connectionType?imperio.dataChannel.send(JSON.stringify(e)):imperio.socket.emit("pan",imperio.room,e),o&&o(e)}),n.on("panstart",function(e){e.start=!0,e.end=!1,e.type="pan","webRTC"===imperio.connectionType?imperio.dataChannel.send(JSON.stringify(e)):imperio.socket.emit("pan",imperio.room,e),o&&o(e)}),n.on("panend",function(e){e.start=!1,e.end=!0,e.type="pan","webRTC"===imperio.connectionType?imperio.dataChannel.send(JSON.stringify(e)):imperio.socket.emit("pan",imperio.room,e),o&&o(e)})};e.exports=n},function(e,o){"use strict";var n=function(e,o){var n=new Hammer(e);n.get("pinch").set({enable:!0}),n.on("pinch",function(e){e.start=!1,e.end=!1,e.type="pinch","webRTC"===imperio.connectionType?imperio.dataChannel.send(JSON.stringify(e)):imperio.socket.emit("pinch",imperio.room,e),o&&o(e)}),n.on("pinchstart",function(e){e.start=!0,e.end=!1,e.type="pinch","webRTC"===imperio.connectionType?imperio.dataChannel.send(JSON.stringify(e)):imperio.socket.emit("pinch",imperio.room,e),o&&o(e)}),n.on("pinchend",function(e){e.start=!1,e.end=!0,e.type="pinch","webRTC"===imperio.connectionType?imperio.dataChannel.send(JSON.stringify(e)):imperio.socket.emit("pinch",imperio.room,e),o&&o(e)})};e.exports=n},function(e,o){"use strict";var n=function(e,o){var n=new Hammer(e);n.on("press",function(e){e.type="press","webRTC"===imperio.connectionType?imperio.dataChannel.send(JSON.stringify(e)):imperio.socket.emit("press",imperio.room,e),o&&o(e)})};e.exports=n},function(e,o){"use strict";var n=function(e,o){var n=new Hammer(e);n.on("pressup",function(e){e.type="pressUp","webRTC"===imperio.connectionType?imperio.dataChannel.send(JSON.stringify(e)):imperio.socket.emit("pressUp",imperio.room,e),o&&o(e)})};e.exports=n},function(e,o){"use strict";var n=function(e,o){var n=new Hammer(e);n.get("rotate").set({enable:!0}),n.on("rotate",function(e){e.start=!1,e.end=!1,e.type="rotate","webRTC"===imperio.connectionType?imperio.dataChannel.send(JSON.stringify(e)):imperio.socket.emit("rotate",imperio.room,e),o&&o(e)}),n.on("rotatestart",function(e){e.start=!0,e.end=!1,e.type="rotate","webRTC"===imperio.connectionType?imperio.dataChannel.send(JSON.stringify(e)):imperio.socket.emit("rotate",imperio.room,e),o&&o(e)}),n.on("rotateend",function(e){e.start=!1,e.end=!0,e.type="rotate","webRTC"===imperio.connectionType?imperio.dataChannel.send(JSON.stringify(e)):imperio.socket.emit("rotate",imperio.room,e),o&&o(e)})};e.exports=n},function(e,o){"use strict";var n=function(e,o){var n=new Hammer(e);n.on("swipe",function(e){"webRTC"===imperio.connectionType?imperio.dataChannel.send(JSON.stringify(e)):imperio.socket.emit("swipe",imperio.room,e),o&&o(e)})};e.exports=n},function(e,o){"use strict";var n={};n.gravity=function(e,o){window.ondevicemotion=function(n){var i=Math.round(n.accelerationIncludingGravity.x),t=Math.round(n.accelerationIncludingGravity.y),r=Math.round(n.accelerationIncludingGravity.z),c={type:"acceleration",x:i,y:t,z:r};o&&(c=o(c)),"webRTC"===imperio.connectionType?imperio.dataChannel.send(JSON.stringify(c)):imperio.socket.emit("acceleration",imperio.room,c),e&&e(c)}},n.noGravity=function(e,o){window.ondevicemotion=function(n){var i=Math.round(n.acceleration.x),t=Math.round(n.acceleration.y),r=Math.round(n.acceleration.z),c={type:"acceleration",x:i,y:t,z:r};o&&(c=o(c)),"webRTC"===imperio.connectionType?imperio.dataChannel.send(JSON.stringify(c)):imperio.socket.emit("acceleration",imperio.room,c),e&&e(c)}},e.exports=n},function(e,o){"use strict";var n=function(e){return navigator.geolocation?void navigator.geolocation.getCurrentPosition(function(o){var n={type:"geoLocation",coordinates:o.coords};"webRTC"===imperio.connectionType?imperio.dataChannel.send(JSON.stringify(n)):imperio.socket.emit("geoLocation",imperio.room,n),e&&e(n)}):void console.log("This browser does not support Geolocation")};e.exports=n},function(e,o){"use strict";var n=function(e,o){window.ondeviceorientation=function(n){var i=Math.round(n.alpha),t=Math.round(n.beta),r=Math.round(n.gamma),c={type:"gyroscope",alpha:i,beta:t,gamma:r};o&&(c=o(c)),"webRTC"===imperio.connectionType?imperio.dataChannel.send(JSON.stringify(c)):imperio.socket.emit("gyroscope",imperio.room,c),e&&e(c)}};e.exports=n},function(e,o){"use strict";var n=function(e){imperio.socket.on("connect",function(){if(imperio.connectionType="sockets",imperio.room){var o={room:imperio.room,id:imperio.socket.id,role:"emitter"};imperio.socket.emit("createRoom",o)}e&&e(imperio.socket)})};e.exports=n},function(e,o){"use strict";var n=function(e){imperio.socket.on("updateRoomData",function(o){e&&e(o)})};e.exports=n},function(e,o){"use strict";var n=function(e,o){"webRTC"===imperio.connectionType?imperio.dataChannel.send("tap"):imperio.socket.emit("tap",imperio.room,o),e&&e(o)};e.exports=n},function(e,o){"use strict";var n=function(e){imperio.socket.emit("updateNonceTimeouts",imperio.room),e&&e()};e.exports=n},function(e,o,n){var i,t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(r,c){"use strict";var a=function(e){if("object"!==t(e.document))throw Error("Cookies.js requires a `window` with a `document` object");var o=function n(e,o,i){return 1===arguments.length?n.get(e):n.set(e,o,i)};return o._document=e.document,o._cacheKeyPrefix="cookey.",o._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),o.defaults={path:"/",secure:!1},o.get=function(e){return o._cachedDocumentCookie!==o._document.cookie&&o._renewCache(),e=o._cache[o._cacheKeyPrefix+e],e===c?c:decodeURIComponent(e)},o.set=function(e,n,i){return i=o._getExtendedOptions(i),i.expires=o._getExpiresDate(n===c?-1:i.expires),o._document.cookie=o._generateCookieString(e,n,i),o},o.expire=function(e,n){return o.set(e,c,n)},o._getExtendedOptions=function(e){return{path:e&&e.path||o.defaults.path,domain:e&&e.domain||o.defaults.domain,expires:e&&e.expires||o.defaults.expires,secure:e&&e.secure!==c?e.secure:o.defaults.secure}},o._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},o._getExpiresDate=function(e,n){if(n=n||new Date,"number"==typeof e?e=1/0===e?o._maxExpireDate:new Date(n.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e)),e&&!o._isValidDate(e))throw Error("`expires` parameter cannot be converted to a valid Date instance");return e},o._generateCookieString=function(e,o,n){return e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent),e=e.replace(/\(/g,"%28").replace(/\)/g,"%29"),o=(o+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),n=n||{},e=e+"="+o+(n.path?";path="+n.path:""),e+=n.domain?";domain="+n.domain:"",e+=n.expires?";expires="+n.expires.toUTCString():"",e+=n.secure?";secure":""},o._getCacheFromString=function(e){var n={};e=e?e.split("; "):[];for(var i=0;i<e.length;i++){var t=o._getKeyValuePairFromCookieString(e[i]);n[o._cacheKeyPrefix+t.key]===c&&(n[o._cacheKeyPrefix+t.key]=t.value)}return n},o._getKeyValuePairFromCookieString=function(e){var o,n=e.indexOf("="),n=0>n?e.length:n,i=e.substr(0,n);try{o=decodeURIComponent(i)}catch(t){console&&"function"==typeof console.error&&console.error('Could not decode cookie with key "'+i+'"',t)}return{key:o,value:e.substr(n+1)}},o._renewCache=function(){o._cache=o._getCacheFromString(o._document.cookie),o._cachedDocumentCookie=o._document.cookie},o._areEnabled=function(){var e="1"===o.set("cookies.js",1).get("cookies.js");return o.expire("cookies.js"),e},o.enabled=o._areEnabled(),o},p="object"===t(r.document)?a(r):a;i=function(){return p}.call(o,n,o,e),!(void 0!==i&&(e.exports=i))}("undefined"==typeof window?void 0:window)},function(e,o,n){"use strict";var i=n(3),t=n(1),r=n(29),c=n(2);e.exports=function(e,o){console.log("Creating Peer connection as initiator?",e,"config:",o),imperio.peerConnection=new RTCPeerConnection(o),imperio.peerConnection.onicecandidate=function(e){console.log("icecandidate event:",e),e.candidate?i({type:"candidate",label:e.candidate.sdpMLineIndex,id:e.candidate.sdpMid,candidate:e.candidate.candidate}):console.log("End of candidates.")},e?(console.log("Creating Data Channel"),imperio.dataChannel=imperio.peerConnection.createDataChannel("phone data",{ordered:!1,maxRetransmits:0}),r(),console.log("Creating an offer"),imperio.peerConnection.createOffer(c,t)):imperio.peerConnection.ondatachannel=function(e){console.log("ondatachannel:",e.channel),imperio.dataChannel=e.channel,r()}}},function(e,o,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function t(e){return c["default"].get(e)}var r=n(26),c=i(r);e.exports=t},function(e,o){"use strict";var n=function(){imperio.dataChannel&&(imperio.dataChannel.onopen=function(){console.log("CHANNEL opened!!!"),imperio.connectionType="webRTC",imperio.dataChannel.onmessage=function(e){var o=JSON.parse(e.data);"acceleration"===o.type&&(delete o.type,imperio.callbacks.acceleration&&imperio.callbacks.acceleration(o)),"gyroscope"===o.type&&(delete o.type,imperio.callbacks.gyroscope&&imperio.callbacks.gyroscope(o)),"geoLocation"===o.type&&(delete o.type,imperio.callbacks.geoLocation&&imperio.callbacks.geoLocation(o)),"tap"===o&&imperio.callbacks.tap&&imperio.callbacks.tap(),"pan"===o.type&&(delete o.type,imperio.callbacks.pan&&imperio.callbacks.pan(o)),"pinch"===o.type&&(delete o.type,imperio.callbacks.pinch&&imperio.callbacks.pinch(o)),"press"===o.type&&(delete o.type,imperio.callbacks.press&&imperio.callbacks.press(o)),"pressUp"===o.type&&(delete o.type,imperio.callbacks.pressUp&&imperio.callbacks.pressUp(o)),"rotate"===o.type&&(delete o.type,imperio.callbacks.rotate&&imperio.callbacks.rotate(o)),"swipe"===o.type&&(delete o.type,imperio.callbacks.swipe&&imperio.callbacks.swipe(o))}})};e.exports=n},function(e,o,n){"use strict";var i=n(1),t=n(2),r=function(e){"offer"===e.type?(console.log("Got offer. Sending answer to peer."),imperio.peerConnection.setRemoteDescription(new RTCSessionDescription(e),function(){},i),imperio.peerConnection.createAnswer(t,i)):"answer"===e.type?(console.log("Got answer."),imperio.peerConnection.setRemoteDescription(new RTCSessionDescription(e),function(){},i)):"candidate"===e.type&&(console.log("Setting candidate."),imperio.peerConnection.addIceCandidate(new RTCIceCandidate({candidate:e.candidate})))};e.exports=r},function(e,o,n){"use strict";var i=n(27),t=n(30),r=n(4),c=function(){r?(imperio.socket.on("created",function(e,o){console.log("Created room, "+e+" - my client ID is, "+o)}),imperio.socket.on("log",function(e){console.log.apply(console,e)}),imperio.socket.on("joined",function(e,o){console.log("This peer has joined room, "+e+", with client ID, "+o),i(!1,imperio.webRTCConfiguration)}),imperio.socket.on("ready",function(){console.log("Socket is ready"),i(!0,imperio.webRTCConfiguration)}),imperio.socket.on("message",function(e){console.log("Client received message: "+e),t(e)})):console.log("WebRTC is not supported, will continue using Sockets.")};e.exports=c}]);
//# sourceMappingURL=imperio.min.js.map