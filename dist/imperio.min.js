/*! Copyright Imperiojs */
!function(e){function o(t){if(n[t])return n[t].exports;var i=n[t]={exports:{},id:t,loaded:!1};return e[t].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}var n={};return o.m=e,o.c=n,o.p="",o(0)}([function(e,o,n){"use strict";function t(e){return e&&e.__esModule?e:{"default":e}}var i=n(24),r=t(i),a={};a.socket=io(),a.room=(0,r["default"])("roomId"),a.nonce=(0,r["default"])("nonce"),a.webRTCSupport=n(28),a.webRTCConfiguration={iceServers:[{url:"stun:stun.l.google.com:19302"}]},a.webRTCConnect=n(27),a.dataChannel=null,a.peerConnection=null,a.mobileTapShare=n(20),a.mobileAccelShare=n(13),a.mobileLocationShare=n(16),a.mobileSwipeShare=n(19),a.mobileGyroShare=n(14),a.mobileGyroTimer=n(15),a.mobileRoomSetup=n(17),a.mobileRoomUpdate=n(18),a.requestNonceTimeout=n(21),a.desktopTapHandler=n(11),a.desktopLocationHandler=n(7),a.desktopAccelHandler=n(4),a.desktopGyroHandler=n(5),a.desktopGyroTimer=n(6),a.desktopSwipeHandler=n(10),a.desktopRoomSetup=n(8),a.desktopRoomUpdate=n(9),a.nonceTimeoutUpdate=n(12),window.imperio=a},function(e,o){"use strict";e.exports=function(e){return console.log(e.toString(),e)}},function(e,o,n){"use strict";var t=n(3),i=n(1),r=function(e){imperio.peerConnection.setLocalDescription(e,function(){t(imperio.peerConnection.localDescription)},i)};e.exports=r},function(e,o){"use strict";var n=function(e){console.log("Client sending message: "+e),imperio.socket.emit("message",e,imperio.room)};e.exports=n},function(e,o){"use strict";var n=function(e){imperio.socket.on("acceleration",function(o){e&&e(o)}),imperio.dataChannel.onmessage=function(o){var n=JSON.parse(o.data);"acceleration"===n.type&&e&&e(n)}};e.exports=n},function(e,o){"use strict";var n=function(e){imperio.webRTCSupport===!0&&"open"===imperio.dataChannel.readyState?imperio.dataChannel.onmessage=function(o){var n=JSON.parse(o.data);"gyroscope"===n.type&&e&&e(n)}:imperio.socket.on("gyroscope",function(o){e&&e(o)})};e.exports=n},function(e,o){"use strict";var n=function(e){imperio.socket.on("gyroscopeTimer",function(o,n,t){e&&e(o,n,t)})};e.exports=n},function(e,o){"use strict";var n=function(e){imperio.webRTCSupport===!0&&"open"===imperio.dataChannel.readyState?imperio.dataChannel.onmessage=function(o){var n=JSON.parse(o.data);"location"===n.type&&e&&e(n)}:imperio.socket.on("geoLocation",function(o){e&&e(o)})};e.exports=n},function(e,o){"use strict";var n=function(e,o,n){e.on("connect",function(){if(o){var t={room:o,id:e.id,role:"receiver"};e.emit("createRoom",t)}n&&n()})};e.exports=n},function(e,o){"use strict";var n=function(e,o){e.on("updateRoomData",function(e){o&&o(e)})};e.exports=n},function(e,o){"use strict";var n={};n.left=function(e,o){e.on("swipeleft",function(){o&&o()})},n.right=function(e,o){e.on("swiperight",function(){o&&o()})},n.up=function(e,o){e.on("swipeup",function(){o&&o()})},n.down=function(e,o){e.on("swipedown",function(){o&&o()})},e.exports=n},function(e,o){"use strict";var n=function(e,o){imperio.webRTCSupport===!0&&imperio.dataChannel&&"open"===imperio.dataChannel.readyState?(console.log("inside WebRTC part of tap handler"),imperio.dataChannel.onmessage=function(e){"tap"===e.data&&o&&o()}):(console.log("inside socket part of tap handler"),e.on("tap",function(){o&&o()}))};e.exports=n},function(e,o){"use strict";var n=function(e,o){e.on("updateNonceTimeouts",function(e){o&&o(e)})};e.exports=n},function(e,o){"use strict";var n={};n.gravity=function(e){window.ondevicemotion=function(o){var n=Math.round(o.accelerationIncludingGravity.x),t=Math.round(o.accelerationIncludingGravity.y),i=Math.round(o.accelerationIncludingGravity.z),r={type:"acceleration",x:n,y:t,z:i};imperio.webRTCSupport===!0&&imperio.dataChannel&&"open"===imperio.dataChannel.readyState?imperio.dataChannel.send(JSON.stringify(r)):imperio.socket.emit("acceleration",imperio.room,r),e&&e(r)}},n.noGravity=function(e,o,n){window.ondevicemotion=function(e){var o=Math.round(e.acceleration.x),t=Math.round(e.acceleration.y),i=Math.round(e.acceleration.z),r={type:"acceleration",x:o,y:t,z:i};imperio.webRTCSupport===!0&&imperio.dataChannel&&"open"===imperio.dataChannel.readyState?imperio.dataChannel.send(JSON.stringify(r)):imperio.socket.emit("acceleration",imperio.room,r),n&&n(r)}},e.exports=n},function(e,o){"use strict";var n=function(e){window.ondeviceorientation=function(o){var n=Math.round(o.alpha),t=Math.round(o.beta),i=Math.round(o.gamma),r={type:"gyroscope",alpha:n,beta:t,gamma:i};imperio.webRTCSupport===!0&&"open"===imperio.dataChannel.readyState?imperio.dataChannel.send(JSON.stringify(r)):imperio.socket.emit("gyroscope",imperio.room,r),e&&e(r)}};e.exports=n},function(e,o){"use strict";var n=function(e){window.ondeviceorientation=function(o){var n=Math.round(o.alpha),t=Math.round(o.beta),i=Math.round(o.gamma),r={alpha:n,beta:t,gamma:i},a=Date.now();imperio.socket.emit("gyroscopeTimer",imperio.room,r,a),e&&e(r)}};e.exports=n},function(e,o){"use strict";var n=function(e){return navigator.geolocation?void navigator.geolocation.getCurrentPosition(function(o){var n={type:"location",coordinates:o.coords};imperio.webRTCSupport===!0&&"open"===imperio.dataChannel.readyState?imperio.dataChannel.send(JSON.stringify(n)):imperio.socket.emit("geoLocation",imperio.room,n),e&&e(n)}):void console.log("This browser does not support Geolocation")};e.exports=n},function(e,o){"use strict";var n=function(e){imperio.socket.on("connect",function(){if(imperio.room){var o={room:imperio.room,id:imperio.socket.id,role:"emitter"};imperio.socket.emit("createRoom",o)}e&&e(imperio.socket)})};e.exports=n},function(e,o){"use strict";var n=function(e,o){e.on("updateRoomData",function(e){o&&o(e)})};e.exports=n},function(e,o){"use strict";var n={};n.left=function(e,o,n,t){new Hammer(n).on("swipeleft",function(){n.innerHTML="swiped-left has been emitted from Imperio",e.emit("swipeleft",o),t&&t()})},n.right=function(e,o,n,t){new Hammer(n).on("swiperight",function(){n.innerHTML="swiped-right has been emitted from Imperio",e.emit("swiperight",o),t&&t()})},n.up=function(e,o,n,t){new Hammer(n).on("swipeup",function(){n.innerHTML="swiped-up has been emitted from Imperio",e.emit("swipeup",o),t&&t()})},e.exports=n},function(e,o){"use strict";var n=function(e){imperio.webRTCSupport===!0&&"open"===imperio.dataChannel.readyState?(console.log("webRTC tap event"),imperio.dataChannel.send("tap")):(console.log("socket tap event"),imperio.socket.emit("tap",imperio.room)),e&&e()};e.exports=n},function(e,o){"use strict";function n(e,o,n){imperio.socket.emit("updateNonceTimeouts",imperio.room),n&&n()}e.exports=n},function(e,o,n){var t,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(r,a){"use strict";var c=function(e){if("object"!==i(e.document))throw Error("Cookies.js requires a `window` with a `document` object");var o=function n(e,o,t){return 1===arguments.length?n.get(e):n.set(e,o,t)};return o._document=e.document,o._cacheKeyPrefix="cookey.",o._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),o.defaults={path:"/",secure:!1},o.get=function(e){return o._cachedDocumentCookie!==o._document.cookie&&o._renewCache(),e=o._cache[o._cacheKeyPrefix+e],e===a?a:decodeURIComponent(e)},o.set=function(e,n,t){return t=o._getExtendedOptions(t),t.expires=o._getExpiresDate(n===a?-1:t.expires),o._document.cookie=o._generateCookieString(e,n,t),o},o.expire=function(e,n){return o.set(e,a,n)},o._getExtendedOptions=function(e){return{path:e&&e.path||o.defaults.path,domain:e&&e.domain||o.defaults.domain,expires:e&&e.expires||o.defaults.expires,secure:e&&e.secure!==a?e.secure:o.defaults.secure}},o._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},o._getExpiresDate=function(e,n){if(n=n||new Date,"number"==typeof e?e=1/0===e?o._maxExpireDate:new Date(n.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e)),e&&!o._isValidDate(e))throw Error("`expires` parameter cannot be converted to a valid Date instance");return e},o._generateCookieString=function(e,o,n){return e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent),e=e.replace(/\(/g,"%28").replace(/\)/g,"%29"),o=(o+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),n=n||{},e=e+"="+o+(n.path?";path="+n.path:""),e+=n.domain?";domain="+n.domain:"",e+=n.expires?";expires="+n.expires.toUTCString():"",e+=n.secure?";secure":""},o._getCacheFromString=function(e){var n={};e=e?e.split("; "):[];for(var t=0;t<e.length;t++){var i=o._getKeyValuePairFromCookieString(e[t]);n[o._cacheKeyPrefix+i.key]===a&&(n[o._cacheKeyPrefix+i.key]=i.value)}return n},o._getKeyValuePairFromCookieString=function(e){var o,n=e.indexOf("="),n=0>n?e.length:n,t=e.substr(0,n);try{o=decodeURIComponent(t)}catch(i){console&&"function"==typeof console.error&&console.error('Could not decode cookie with key "'+t+'"',i)}return{key:o,value:e.substr(n+1)}},o._renewCache=function(){o._cache=o._getCacheFromString(o._document.cookie),o._cachedDocumentCookie=o._document.cookie},o._areEnabled=function(){var e="1"===o.set("cookies.js",1).get("cookies.js");return o.expire("cookies.js"),e},o.enabled=o._areEnabled(),o},s="object"===i(r.document)?c(r):c;t=function(){return s}.call(o,n,o,e),!(void 0!==t&&(e.exports=t))}("undefined"==typeof window?void 0:window)},function(e,o,n){"use strict";var t=n(3),i=n(1),r=n(25),a=n(2);e.exports=function(e,o){console.log("Creating Peer connection as initiator?",e,"config:",o),imperio.peerConnection=new RTCPeerConnection(o),imperio.peerConnection.onicecandidate=function(e){console.log("icecandidate event:",e),e.candidate?t({type:"candidate",label:e.candidate.sdpMLineIndex,id:e.candidate.sdpMid,candidate:e.candidate.candidate}):console.log("End of candidates.")},e?(console.log("Creating Data Channel"),imperio.dataChannel=imperio.peerConnection.createDataChannel("phone data",{ordered:!1,maxRetransmits:0}),r(),console.log("Creating an offer"),imperio.peerConnection.createOffer(a,i)):imperio.peerConnection.ondatachannel=function(e){console.log("ondatachannel:",e.channel),imperio.dataChannel=e.channel,r()}}},function(e,o,n){"use strict";function t(e){return e&&e.__esModule?e:{"default":e}}function i(e){return a["default"].get(e)}var r=n(22),a=t(r);e.exports=i},function(e,o){"use strict";var n=function(){imperio.dataChannel&&(imperio.dataChannel.onopen=function(){console.log("CHANNEL opened!!!"),imperio.connectionType="webRTC",imperio.dataChannel.onmessage=function(e){var o=JSON.parse(e.data);"acceleration"===o.type&&(delete o.type,imperio.callbacks.acceleration&&imperio.callbacks.acceleration(o))}})};e.exports=n},function(e,o,n){"use strict";var t=n(1),i=n(2),r=function(e){"offer"===e.type?(console.log("Got offer. Sending answer to peer."),imperio.peerConnection.setRemoteDescription(new RTCSessionDescription(e),function(){},t),imperio.peerConnection.createAnswer(i,t)):"answer"===e.type?(console.log("Got answer."),imperio.peerConnection.setRemoteDescription(new RTCSessionDescription(e),function(){},t)):"candidate"===e.type&&(console.log("Setting candidate."),imperio.peerConnection.addIceCandidate(new RTCIceCandidate({candidate:e.candidate})))};e.exports=r},function(e,o,n){"use strict";var t=n(23),i=n(26),r=function(){imperio.socket.on("created",function(e,o){console.log("Created room, "+e+" - my client ID is, "+o)}),imperio.socket.on("log",function(e){console.log.apply(console,e)}),imperio.socket.on("joined",function(e,o){console.log("This peer has joined room, "+e+", with client ID, "+o),t(!1,imperio.webRTCConfiguration)}),imperio.socket.on("ready",function(){console.log("Socket is ready"),t(!0,imperio.webRTCConfiguration)}),imperio.socket.on("message",function(e){console.log("Client received message: "+e),i(e)})};e.exports=r},function(e,o){"use strict";var n=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;e.exports=!!n&&!!t}]);
//# sourceMappingURL=imperio.min.js.map